const __vite__fileDeps=["_astro/web.7rxOOK1V.js","_astro/index.D7_7wx8r.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{j as r}from"./jsx-runtime.K1e75nIr.js";import{C as h}from"./consts.BQrVI9U1.js";import{u as d}from"./GlobalContext.EMmJ4Qgo.js";import{r as f,C as x}from"./index.D7_7wx8r.js";import{_ as g}from"./astro/assets-service.BTYAIIqN.js";const b={src:"/_astro/heart.CiVxwkig.svg",width:24,height:24,format:"svg"};function v({type:e,message:o,like:t,bgMessage:s}){const n=e==="received"?"flex-initial":"flex-row-reverse",a=e==="received"?"rounded-tr-[25px]":"rounded-tl-[25px]",c=e==="received"?"pr-0":"pl-15",l=s||h.bgSecondary,i=e==="sent"?"bg-white":l,{mode:S,borderClass:p,textClass:u,textClass2:_}=d();return r.jsxs("div",{className:`flex ${n} ${c} w-full gap-2 items-center mb-4`,children:[r.jsxs("div",{className:"max-w-[40vw] text-left flex flex-col",children:[r.jsx("span",{className:`${i} ${a} py-3 px-5 text-black border ${p} rounded-b-[25px]`,children:o}),e==="sent"&&r.jsx("small",{className:`${u} w-full text-right p-1`,children:"Enviado"})]}),e==="received"&&r.jsx("button",{type:"button",children:r.jsx("img",{src:b.src,width:30,className:"min-w-[30px]",alt:"Like"})})]})}function w({text:e,userLogin:o}){const{mode:t}=d(),s=t=="dark"?"text-white":"text-black";return r.jsx("div",{className:"bg-transparent the-time text-center p-2 w-full rounded-xl",children:r.jsx("small",{className:`${s}`,children:r.jsx("time",{dateTime:e,children:e})})})}const T=({messages:e,userLogin:o})=>r.jsx(r.Fragment,{children:e&&e.map((t,s)=>r.jsxs("div",{className:"flex flex-col w-full items-start",children:[t.creado_el&&r.jsx(w,{text:t.creado_el,userLogin:o}),r.jsx(v,{type:t.from_user_id===o.id?"sent":"received",message:t.message,like:t.like,bgMessage:t.from_user_id==="KimikChat"?"bg-[#fda100]":void 0})]},s))}),j=f("Device",{web:()=>g(()=>import("./web.7rxOOK1V.js"),__vite__mapDeps([0,1])).then(e=>new e.DeviceWeb)}),m="http://localhost:1234/v1/chat/completions";async function k(){const e=await j.getInfo();return e.platform==="ios"||e.platform==="android"}const y=async e=>{try{return await x.request({method:"POST",url:m,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer lm-studio"},data:{model:"model-identifier",messages:[{role:"system",content:"Te llamas Kimik, un asistente de IA útil, inteligente, amable y eficiente. Siempre cumples con las solicitudes de los usuarios de la mejor manera posible. Eres un experto psicólogo en relaciones con más de 20 años de experiencia. Siempre respondes en español de manera concisa. Sólo hablas de relaciones"},{role:"user",content:e}],temperature:.7}})}catch{return"Error al conectar con Kimik IA"}},I=async(e,o)=>{if(await k())return await y(e);try{const t=await fetch(m,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer lm-studio"},body:JSON.stringify({model:"model",messages:[{role:"system",content:"Te llamas Kimik, un asistente de IA útil, inteligente, amable y eficiente. Siempre cumples con las solicitudes de los usuarios de la mejor manera posible. Eres un experto psicólogo en relaciones con más de 20 años de experiencia. Siempre respondes en español de manera concisa. Sólo hablas de relaciones"},{role:"user",content:e}],temperature:.7,stream:!0})});if(!t.body)return"Error al conectar con Kimik IA";const s=t.body.getReader(),n=new TextDecoder;let a={role:"assistant",content:""};for(;;){const{done:c,value:l}=await s.read();if(c)break;const i=n.decode(l);a.content+=i,o&&o(i)}return a.content}catch(t){return console.log(t),"Error al conectar con LLM"}};function L(e){const o=typeof e!="object"?e.split(`
`):["data:"+JSON.stringify(e.data)],t=[];return o.forEach(s=>{const n=C(s);t.push(n)}),t}function C(e){if(e.trim().length>0){const t=e.trim().replace(/^data:\s*/,"").replace(/,$/,"");let s={};try{if(t==="[DONE]"||t=="")return;s=t!==void 0&&t!==""&&t.indexOf("{")>-1?JSON.parse(t):""}catch(a){console.log("Error parsing JSON:",a)}const n=s.choices&&s.choices.length>0&&s.choices[0].delta?s.choices[0].delta.content:s.choices&&s.choices.length>0&&s.choices[0].message?s.choices[0].message.content:"";return n===void 0?"":n}}export{T as C,v as a,C as b,L as c,I as p};
